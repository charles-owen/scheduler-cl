"use strict";(self.webpackChunkcourselib=self.webpackChunkcourselib||[]).push([[533],{33547:(e,t,n)=>{var i=n(29428),o=n(24309),l=n(34802),a={class:"content cl-schedule-view"},s={class:"cl-time"},r={class:"full"},c=["onUpdate:modelValue"],u={class:"cl-info"},d={key:0},h={key:0,class:"gap"},m=[(0,l._)("td",null," ",-1),(0,l._)("td",null," ",-1)],f={class:"time"},g=(0,l._)("br",null,null,-1),p=["onClick"],v=["src"],b=(0,l._)("br",null,null,-1),w=["onClick"],k=["src"],y={key:0,class:"booked"},_={key:1,class:"booked"},D=["onClick"],S=["onClick"],x={class:"location"},$={key:3,class:"counter"},C={key:4,class:"check"},M=["onUpdate:modelValue"],A={key:5,class:"unbook"},I=["onClick"],T=["src"];var U=function e(t){void 0!==t?(this.id=t.id,this.tag=t.tag,this.name=t.name,this.teaming=t.teaming,this.assigntag=null===t.assigntag?"none":t.assigntag):(this.id=0,this.tag="",this.name="",this.teaming=0,this.assigntag="none"),this.clone=function(){return new e(this)}},z=function e(t){void 0!==t?(this.id=t.id,this.time=t.time,this.duration=t.duration,this.updated=t.updated,this.location=t.location,this.teamId=t.teamId,this.teamName=t.teamName,this.memberId=t.memberId):(this.id=0,this.time=0,this.duration=10,this.updated=0,this.location="",this.teamName=null,this.teamId=null,this.memberId=null),this.repeat=1,this.contiguous=!1,this.checked=!1,this.clone=function(){return new e(this)},this.booked=function(){return null!==this.teamId||null!==this.memberId}},E=function(e){return(0,l.dD)("data-v-2d7c02fe"),e=e(),(0,l.Cn)(),e},N={class:"dialog-cl-column"},V={class:"flatpickr"},Z=E((function(){return(0,l._)("br",null,null,-1)})),O=E((function(){return(0,l._)("a",{"data-toggle":"",title:"Toggle Calendar"},[(0,l._)("span",{class:"icons-cl icons-cl-calendar"})],-1)})),q=E((function(){return(0,l._)("br",null,null,-1)})),B={key:1,class:"center"};var j=n(25386);n(63270);const F={props:["schedule-slot","location-only"],data:function(){return{time:null,fpConfig:{enableTime:!0,dateFormat:"m-d-Y h:iK",wrap:!0}}},components:{flatPickr:j.Z},mounted:function(){this.time=0!==this.scheduleSlot.time?1e3*this.scheduleSlot.time:null},updated:function(){if(null!==this.time&&"number"!=typeof this.time){var e=this.time.match(/([0-9]*)-([0-9]*)-([0-9]*)\s([0-9]*):([0-9]*)([AP])/),t=+e[4];"P"===e[6]?t<12&&(t+=12):12===t&&(t=0);var n=new Date(e[3],e[1]-1,e[2],t,e[5]);this.scheduleSlot.time=""!==this.time?Math.floor(n.getTime()/1e3):0}}};var Y=n(68572),K=n.n(Y),H=n(84879),P=n.n(H),L=n(55438),X=n.n(L),R=n(59425),W=n.n(R),G=n(37930),J=n.n(G),Q=n(76686),ee=n.n(Q),te=n(77370),ne={};ne.styleTagTransform=ee(),ne.setAttributes=W(),ne.insert=X().bind(null,"head"),ne.domAPI=P(),ne.insertStyleElement=J();K()(te.Z,ne);te.Z&&te.Z.locals&&te.Z.locals;var ie=n(76906);const oe=(0,ie.Z)(F,[["render",function(e,t,n,i,o,a){var s=(0,l.up)("flat-pickr");return(0,l.wg)(),(0,l.iD)("div",N,[(0,l._)("div",null,[(0,l._)("form",null,[e.locationOnly?(0,l.kq)("v-if",!0):((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[(0,l._)("p",V,[(0,l._)("label",null,[(0,l.Uk)("Date and Time"),Z,(0,l.Wm)(s,{modelValue:e.time,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.time=t}),config:e.fpConfig,"data-input":""},null,8,["modelValue","config"]),O])]),(0,l._)("p",null,[(0,l._)("label",null,[(0,l.Uk)("Duration (minutes): "),(0,l.wy)((0,l._)("input",{class:"narrow",type:"text","onUpdate:modelValue":t[1]||(t[1]=function(t){return e.scheduleSlot.duration=t})},null,512),[[l.nr,e.scheduleSlot.duration]])])])],64)),(0,l._)("p",null,[(0,l._)("label",null,[(0,l.Uk)("Location"),q,(0,l.wy)((0,l._)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=function(t){return e.scheduleSlot.location=t})},null,512),[[l.nr,e.scheduleSlot.location]])])]),0===e.scheduleSlot.id?((0,l.wg)(),(0,l.iD)("p",B,[(0,l._)("label",null,[(0,l.Uk)("Repeat: "),(0,l.wy)((0,l._)("input",{class:"narrow",type:"text","onUpdate:modelValue":t[3]||(t[3]=function(t){return e.scheduleSlot.repeat=t})},null,512),[[l.nr,e.scheduleSlot.repeat]])])])):(0,l.kq)("v-if",!0)])])])}],["__scopeId","data-v-2d7c02fe"]]);var le={key:0},ae={key:0},se={key:1},re=["href"],ce={class:"cl-schedule-team-email"},ue=["href"],de={key:1,class:"cl-schedule-team-fetching"},he=[(0,l._)("p",null,"Fetching...",-1)];function me(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return fe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fe(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,l=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw l}}}}function fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}const ge={extends:Site.UserVueBase,props:["view-slot","schedule"],data:function(){return{team:null,email:"mailto:",link:null}},mounted:function(){var e=this;"none"!==this.schedule.assigntag&&(this.link=this.root+"/cl/console/grading/"+this.schedule.assigntag+"/"),this.site.api.get("/api/team/"+ +this.viewSlot.teamId).then((function(t){t.hasError()?e.site.toast(e,t):e.take(t.getData("team").attributes)})).catch((function(t){e.site.toast(e,t)}))},methods:{take:function(e){this.team=e;var t=!0;this.email="";var n,i=me(e.members);try{for(i.s();!(n=i.n()).done;){var o=n.value;""!==o.email&&(t?(this.email="mailto:",t=!1):this.email+=";",this.email+=o.email)}}catch(e){i.e(e)}finally{i.f()}if(""!==this.email){var l=encodeURIComponent(e.name);this.email+="?subject=Team%20"+l}}}};var pe=n(24549),ve={};ve.styleTagTransform=ee(),ve.setAttributes=W(),ve.insert=X().bind(null,"head"),ve.domAPI=P(),ve.insertStyleElement=J();K()(pe.Z,ve);pe.Z&&pe.Z.locals&&pe.Z.locals;const be=(0,ie.Z)(ge,[["render",function(e,t,n,i,o,a){return null!==e.team?((0,l.wg)(),(0,l.iD)("div",le,[(0,l._)("table",null,[(0,l._)("tr",null,[(0,l._)("th",null,(0,l.zw)(e.team.name),1)]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.team.members,(function(t){return(0,l.wg)(),(0,l.iD)("tr",null,["none"===n.schedule.assigntag?((0,l.wg)(),(0,l.iD)("td",ae,(0,l.zw)(t.name),1)):((0,l.wg)(),(0,l.iD)("td",se,[(0,l._)("a",{href:e.link+t.memberid},(0,l.zw)(t.name),9,re)]))])})),256))]),(0,l._)("p",ce,[(0,l._)("a",{href:e.email},"email",8,ue)])])):((0,l.wg)(),(0,l.iD)("div",de,he))}]]);function we(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ke(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ke(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,l=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw l}}}}function ke(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var ye=Site.Member,_e=Site.VueHelper;const De={extends:Site.UserVueBase,props:["json"],data:function(){return{schedule:null,days:[],teamMode:!1,team:null,staff:!1,latest:0,time:0,timeStr:"",timer:0}},mounted:function(){var e=this;new this.$site.StickyNav("nav.cl-nav"),this.clearMenu(),this.schedule=new U(this.json.schedule),this.setTime(),this.timer=setInterval((function(){e.setTime()}),1e3),this.newSlots(this.json.slots),void 0!==this.json.team&&(this.teamMode=!0,this.team=this.json.team),this.setTitle(this.schedule.name),this.staff=this.user.atLeast(ye.STAFF),this.staff&&(this.addMenu("Add Slot",(function(){e.add()})),this.addMenu("Check Future",(function(){e.checkFuture()}))),this.$site.polling.addClient("scheduler",(function(t){t.scheduler={scheduleId:e.schedule.id,after:e.latest}}),(function(t){e.take(t)}))},unmounted:function(){clearInterval(this.timer),this.timer=0},methods:{take:function(e){var t=e.getData("slots");if(null!==t){var n=t.attributes;this.newSlots(n)}},owned:function(e){return this.teamMode?null!==this.team&&e.teamId===this.team.id:this.user.member.id===e.memberId},ownedForDay:function(e){var t,n=0,i=we(e.slots);try{for(i.s();!(t=i.n()).done;){t.value.booked()&&n++}}catch(e){i.e(e)}finally{i.f()}return n},setTime:function(){this.time=Math.round((new Date).getTime()/1e3),this.timeStr=this.$site.TimeFormatter.absoluteUNIX(this.time,"long-time")},book:function(e){var t=this,n={id:e.id,teamMode:this.teamMode?1:0};if(this.teamMode){if(null===this.team)return void this.$site.toast(this,"Not a member of a team!");n.teamId=this.team.id}this.$site.api.post("/api/scheduler/slots/"+this.schedule.id+"/book",n).then((function(e){e.hasError()?t.$site.toast(t,e):t.take(e)})).catch((function(e){t.$site.toast(t,e)}))},unbook:function(e){var t=this;this.$site.api.post("/api/scheduler/slots/"+this.schedule.id+"/unbook",{id:e.id}).then((function(e){e.hasError()?t.$site.toast(t,e):t.take(e)})).catch((function(e){t.$site.toast(t,e)}))},newSlots:function(e){this.days=[];var t,n={},i=null,o=[],l=we(e);try{for(l.s();!(t=l.n()).done;){var a=t.value,s=new z(a);null!==s.teamId&&(void 0===n[s.teamId]?(s.count=1,n[s.teamId]=1):(n[s.teamId]++,s.count=n[s.teamId])),s.updated>this.latest&&(this.latest=s.updated);var r=this.$site.TimeFormatter.absoluteUNIX(s.time,"long-date");if(r!==i&&(o.length>0&&this.addDay(i,o),i=r,o=[]),o.length>0){var c=o[o.length-1];c.time+60*c.duration>=s.time&&(s.contiguous=!0)}o.push(s)}}catch(e){l.e(e)}finally{l.f()}o.length>0&&this.addDay(i,o)},addDay:function(e,t){var n=Math.round((new Date).getTime()/1e3),i=this.$site.TimeFormatter.absoluteUNIX(n,"long-date"),o=Date.parse(e)>=Date.parse(i);this.days.push({day:e,open:o,slots:t})},add:function(){var e=this,t=new z;new this.$site.Dialog({title:"New Slot",content:'<div id="cl-schedule-slot"></div>',addClass:"cl-schedule-dialog",buttons:[{contents:"Add",focus:!0,click:function(n){if(""!==t.time&&0!==t.time){var i={time:t.time,duration:t.duration,location:t.location,repeat:t.repeat};e.$site.api.post("/api/scheduler/slots/"+e.schedule.id+"/new",i).then((function(t){t.hasError()?e.$site.toast(e,t):(e.take(t),n.close())})).catch((function(t){e.$site.toast(e,t)}))}else new e.$site.Dialog.MessageBox("Must enter time","You must provide a date and time",e.$site.Dialog.MessageBox.OK)}},{contents:"Cancel",click:function(e){e.close()}}]}),this.dialogVue(t)},editor:function(e){var t=this,n=this.checked();e=n.length>0?n[0].clone:e.clone(),new this.$site.Dialog({title:"Edit Slot",content:'<div id="cl-schedule-slot"></div>',addClass:"cl-schedule-dialog",buttons:[{contents:"Update",focus:!0,click:function(i){if(""!==e.time&&0!==e.time)if(0===n.length){var o={id:e.id,time:e.time,duration:e.duration,location:e.location};t.$site.api.post("/api/scheduler/slots/"+t.schedule.id+"/update",o).then((function(e){e.hasError()?t.$site.toast(t,e):(t.take(e),i.close())})).catch((function(e){t.$site.toast(t,e)}))}else{i.close();var l,a=we(n);try{for(a.s();!(l=a.n()).done;){var s=l.value,r={id:s.id,time:s.time,duration:s.duration,location:e.location};t.$site.api.post("/api/scheduler/slots/"+t.schedule.id+"/update",r).then((function(e){e.hasError()?t.$site.toast(t,e):t.take(e)})).catch((function(e){t.$site.toast(t,e)}))}}catch(e){a.e(e)}finally{a.f()}}else new t.$site.Dialog.MessageBox("Must enter time","You must provide a date and time",t.$site.Dialog.MessageBox.OK)}},{contents:"Cancel",click:function(e){e.close()}}]}),this.dialogVue(e,n.length>0)},dialogVue:function(e){var t=!!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]),n=_e.createApp({data:function(){return{slot:e,lo:t}},template:'\n          <editor :schedule-slot="slot" :location-only="lo"></editor>',components:{editor:oe}});n.config.globalProperties.$site=this.$site,n.mount("#cl-schedule-slot")},deleter:function(e){var t=this;new this.$site.Dialog.MessageBox("Are you sure?","Are you sure you want to delete?",this.$site.Dialog.MessageBox.OKCANCEL,(function(){var n=t.checked();if(0===n.length)t.deleteSlot(e);else{var i,o=we(n);try{for(o.s();!(i=o.n()).done;){var l=i.value;t.deleteSlot(l)}}catch(e){o.e(e)}finally{o.f()}}}))},deleteSlot:function(e){var t=this;this.$site.api.post("/api/scheduler/slots/"+this.schedule.id+"/delete",{id:e.id}).then((function(e){e.hasError()?t.$site.toast(t,e):t.take(e)})).catch((function(e){t.$site.toast(t,e)}))},checked:function(){var e,t=[],n=we(this.days);try{for(n.s();!(e=n.n()).done;){var i,o=we(e.value.slots);try{for(o.s();!(i=o.n()).done;){var l=i.value;l.checked&&t.push(l)}}catch(e){o.e(e)}finally{o.f()}}}catch(e){n.e(e)}finally{n.f()}return t},slotClass:function(e){return e.booked()?this.owned(e)?"booked owned":"booked":""},showTeam:function(e){new(0,this.$site.Dialog)({title:"Team",content:'<div id="cl-schedule-team"></div>',addClass:"cl-dialog-narrow",buttons:[{contents:"Ok",click:function(e){e.close()}}]});var t=this.schedule;_e.createApp({data:function(){return{slot:e,schedule:t}},template:'\n          <viewer :view-slot="slot" :schedule="schedule"></viewer>',components:{viewer:be}}).mount("#cl-schedule-team")},checkFuture:function(){var e,t=Math.floor(Date.now()/1e3),n=we(this.days);try{for(n.s();!(e=n.n()).done;){var i,o=we(e.value.slots);try{for(o.s();!(i=o.n()).done;){var l=i.value;l.time>t&&(l.checked=!0)}}catch(e){o.e(e)}finally{o.f()}}}catch(e){n.e(e)}finally{n.f()}},timeFormat:function(e){return this.$site.TimeFormatter.absoluteUNIX(e,"short-time")}}};var Se=n(14121),xe={};xe.styleTagTransform=ee(),xe.setAttributes=W(),xe.insert=X().bind(null,"head"),xe.domAPI=P(),xe.insertStyleElement=J();K()(Se.Z,xe);Se.Z&&Se.Z.locals&&Se.Z.locals;const $e=(0,ie.Z)(De,[["render",function(e,t,n,i,o,U){return(0,l.wg)(),(0,l.iD)("div",a,[(0,l._)("div",s,(0,l.zw)(e.timeStr),1),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.days,(function(t){return(0,l.wg)(),(0,l.iD)("div",r,[(0,l._)("h2",null,[(0,l.wy)((0,l._)("input",{type:"checkbox","onUpdate:modelValue":function(e){return t.open=e}},null,8,c),[[l.e8,t.open]]),(0,l.Uk)(" "+(0,l.zw)(t.day)+" ",1),(0,l._)("span",u,(0,l.zw)(t.slots.length)+" slots/"+(0,l.zw)(t.slots.length-U.ownedForDay(t))+" open",1)]),t.open?((0,l.wg)(),(0,l.iD)("table",d,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.slots,(function(t){return(0,l.wg)(),(0,l.iD)(l.HY,null,[t.contiguous?(0,l.kq)("v-if",!0):((0,l.wg)(),(0,l.iD)("tr",h,m)),(0,l._)("tr",{class:(0,l.C_)(U.slotClass(t))},[(0,l._)("td",null,[(0,l._)("span",f,(0,l.zw)(U.timeFormat(t.time)),1),e.staff?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[g,(0,l._)("a",{onClick:(0,l.iM)((function(e){return U.editor(t)}),["prevent"])},[(0,l._)("img",{src:e.root+"/vendor/cl/site/img/pencil16.png",alt:"Edit",title:"Edit"},null,8,v)],8,p),b,(0,l._)("a",{onClick:(0,l.iM)((function(e){return U.deleter(t)}),["prevent"])},[(0,l._)("img",{src:e.root+"/vendor/cl/site/img/x.png",alt:"Delete",title:"Delete"},null,8,k)],8,w)],64)):(0,l.kq)("v-if",!0)]),(0,l._)("td",null,[!e.staff&&t.booked()?((0,l.wg)(),(0,l.iD)("span",y,(0,l.zw)(t.teamName),1)):(0,l.kq)("v-if",!0),e.staff&&t.booked()?((0,l.wg)(),(0,l.iD)("span",_,[(0,l._)("a",{onClick:(0,l.iM)((function(e){return U.showTeam(t)}),["prevent"])},(0,l.zw)(t.teamName),9,D)])):(0,l.kq)("v-if",!0),!t.booked()&&t.time>e.time?((0,l.wg)(),(0,l.iD)("a",{key:2,onClick:(0,l.iM)((function(e){return U.book(t)}),["prevent"])},"Click to Book",8,S)):(0,l.kq)("v-if",!0),(0,l._)("span",x,(0,l.zw)(t.location),1),e.staff&&t.booked()?((0,l.wg)(),(0,l.iD)("span",$,(0,l.zw)(t.count),1)):(0,l.kq)("v-if",!0),e.staff?((0,l.wg)(),(0,l.iD)("span",C,[(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":function(e){return t.checked=e},type:"checkbox"},null,8,M),[[l.e8,t.checked]])])):(0,l.kq)("v-if",!0),t.booked()&&(e.staff||U.owned(t)&&t.time>e.time)?((0,l.wg)(),(0,l.iD)("span",A,[(0,l._)("a",{onClick:(0,l.iM)((function(e){return U.unbook(t)}),["prevent"])},[(0,l._)("img",{src:e.root+"/vendor/cl/site/img/x.png",alt:"Unbook",title:"Unbook"},null,8,T)],8,I)])):(0,l.kq)("v-if",!0)])],2)],64)})),256))])):(0,l.kq)("v-if",!0)])})),256))])}]]);var Ce=function(){};Ce.create=function(e){return e.ready((function(){i.s.create("div.cl-schedule-view","Schedule",$e,{nav:o.Z,replace:!0})})),!0};var Me=n(13904),Ae={class:"content"},Ie={key:0,class:"full"},Te={key:0},Ue=(0,l._)("th",null,null,-1),ze=(0,l._)("th",null,"Tag",-1),Ee=(0,l._)("th",null,"Name",-1),Ne={key:0},Ve=["onClick"],Ze=["src"],Oe=["onClick"],qe=["src"],Be=["href"],je={key:0},Fe={key:1,class:"center"},Ye=[(0,l._)("p",null,"There are currently no defined schedules.",-1),(0,l._)("p",null,"Choose Add Schedule to add a new schedule.",-1)];var Ke={style:{padding:"0 1em"},class:"dialog-cl-column"},He=(0,l._)("br",null,null,-1),Pe=(0,l._)("br",null,null,-1),Le={key:0},Xe=(0,l._)("label",null,"Teaming",-1),Re=(0,l._)("br",null,null,-1),We=(0,l._)("option",{value:0},"None",-1),Ge=["value"],Je={key:1},Qe=(0,l._)("label",null,"Assignment",-1),et=(0,l._)("br",null,null,-1),tt=(0,l._)("option",{value:"none"},"None",-1),nt=["value"];const it={props:["schedule","teamings","assignments"],mounted:function(){this.$refs.tag.focus()}},ot=(0,ie.Z)(it,[["render",function(e,t,n,i,o,a){return(0,l.wg)(),(0,l.iD)("div",Ke,[(0,l._)("div",null,[(0,l._)("form",null,[(0,l._)("p",null,[(0,l._)("label",null,[(0,l.Uk)("Tag"),He,(0,l.wy)((0,l._)("input",{ref:"tag",type:"text","onUpdate:modelValue":t[0]||(t[0]=function(e){return n.schedule.tag=e})},null,512),[[l.nr,n.schedule.tag]])])]),(0,l._)("p",null,[(0,l._)("label",null,[(0,l.Uk)("Name"),Pe,(0,l.wy)((0,l._)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=function(e){return n.schedule.name=e})},null,512),[[l.nr,n.schedule.name]])])]),null!==n.teamings?((0,l.wg)(),(0,l.iD)("p",Le,[Xe,Re,(0,l.wy)((0,l._)("select",{"onUpdate:modelValue":t[2]||(t[2]=function(e){return n.schedule.teaming=e})},[We,((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.teamings,(function(e){return(0,l.wg)(),(0,l.iD)("option",{value:e.id},(0,l.zw)(e.name),9,Ge)})),256))],512),[[l.bM,n.schedule.teaming]])])):(0,l.kq)("v-if",!0),null!==n.teamings?((0,l.wg)(),(0,l.iD)("p",Je,[Qe,et,(0,l.wy)((0,l._)("select",{"onUpdate:modelValue":t[3]||(t[3]=function(e){return n.schedule.assigntag=e})},[tt,((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.assignments,(function(e){return(0,l.wg)(),(0,l.iD)("option",{value:e.tag},(0,l.zw)(e.name),9,nt)})),256))],512),[[l.bM,n.schedule.assigntag]])])):(0,l.kq)("v-if",!0)])])])}]]);function lt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return at(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return at(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,l=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw l}}}}function at(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var st=Site.VueHelper;const rt={extends:Site.ConsoleComponentBase,data:function(){return{teamings:null,schedules:null}},mounted:function(){var e=this;this.setTitle(": Schedules"),this.addNav2("Add Schedule",5,(function(){e.add()})),this.$site.api.get("/api/scheduler/schedules",{}).then((function(t){t.hasError()?e.$site.toast(e,t):e.take(t)})).catch((function(t){e.$site.toast(e,t)}))},methods:{teamingName:function(e){var t,n=lt(this.teamings);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(+i.id==+e)return i.name}}catch(e){n.e(e)}finally{n.f()}return"None"},take:function(e){var t=e.getData("schedules").attributes;this.schedules=[];var n,i=lt(t);try{for(i.s();!(n=i.n()).done;){var o=n.value;this.schedules.push(new U(o))}}catch(e){i.e(e)}finally{i.f()}var l=e.getData("teamings");null!==l&&(this.teamings=l.attributes)},add:function(){var e=this,t=new U,n=this.$site.Dialog;new n({title:"New Schedule",content:'<div id="cl-schedule"></div>',buttons:[{contents:"Add",focus:!0,click:function(i){if(e.$site.Tags.validate(t.tag))if(""!==t.name.trim()){var o={tag:t.tag.trim(),name:t.name.trim(),teaming:t.teaming,assigntag:"none"!==t.assigntag?t.assigntag:null};e.$site.api.post("/api/scheduler/schedules/new",o).then((function(t){t.hasError()?e.$site.toast(e,t):(e.take(t),i.close())})).catch((function(t){e.$site.toast(e,t)}))}else new n.MessageBox("Must enter name","You must provide a non-empty name",n.MessageBox.OK)}},{contents:"Cancel",click:function(e){e.close()}}]}),this.dialogVue(t)},editor:function(e){var t=this;e=e.clone();var n=this.$site.Dialog;new n({title:"Edit Schedule",content:'<div id="cl-schedule"></div>',buttons:[{contents:"Update",focus:!0,click:function(i){if(t.$site.Tags.validate(e.tag))if(""!==e.name.trim()){var o={id:e.id,tag:e.tag.trim(),name:e.name.trim(),teaming:e.teaming,assigntag:"none"!==e.assigntag?e.assigntag:null};t.$site.api.post("/api/scheduler/schedules/update",o).then((function(e){e.hasError()?t.$site.toast(t,e):(t.take(e),i.close())})).catch((function(e){t.$site.toast(t,e)}))}else new n.MessageBox("Must enter name","You must provide a non-empty name",n.MessageBox.OK)}},{contents:"Cancel",click:function(e){e.close()}}]}),this.dialogVue(e)},dialogVue:function(e){var t,n=this.teamings,i=this.$store.state.user.user.member,o=this.$store.getters["course/section"](i.semester,i.section),l=[],a=lt(o.assignments.categories);try{for(a.s();!(t=a.n()).done;){var s,r=lt(t.value.assignments);try{for(r.s();!(s=r.n()).done;){var c=s.value;l.push(c)}}catch(e){r.e(e)}finally{r.f()}}}catch(e){a.e(e)}finally{a.f()}l.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0})),st.createApp({data:function(){return{schedule:e,teamings:n,assignments:l}},template:'<editor :schedule="schedule" :teamings="teamings" :assignments="assignments"></editor>',components:{editor:ot}}).mount("#cl-schedule")},deleter:function(e){var t=this,n=this.$site.Dialog;new n.MessageBox("Are you sure?","Are you sure you want to delete "+e.name,n.MessageBox.OKCANCEL,(function(){t.$site.api.post("/api/scheduler/schedules/delete",{id:e.id}).then((function(e){e.hasError()?t.$site.toast(t,e):(t.take(e),dialog.close())})).catch((function(e){t.$site.toast(t,e)}))}))}}},ct=(0,ie.Z)(rt,[["render",function(e,t,n,i,o,a){return(0,l.wg)(),(0,l.iD)("div",Ae,[null!==e.schedules?((0,l.wg)(),(0,l.iD)("div",Ie,[e.schedules.length>0?((0,l.wg)(),(0,l.iD)("table",Te,[(0,l._)("tr",null,[Ue,ze,Ee,null!==e.teamings?((0,l.wg)(),(0,l.iD)("th",Ne,"Teaming")):(0,l.kq)("v-if",!0)]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.schedules,(function(t){return(0,l.wg)(),(0,l.iD)("tr",{key:t.id},[(0,l._)("td",null,[(0,l._)("a",{onClick:(0,l.iM)((function(e){return a.editor(t)}),["prevent"])},[(0,l._)("img",{src:e.root+"/vendor/cl/site/img/pencil16.png",alt:"Edit",title:"Edit"},null,8,Ze)],8,Ve),(0,l._)("a",{onClick:(0,l.iM)((function(e){return a.deleter(t)}),["prevent"])},[(0,l._)("img",{src:e.root+"/vendor/cl/site/img/x.png",alt:"Delete",title:"Delete"},null,8,qe)],8,Oe)]),(0,l._)("td",null,[(0,l._)("a",{href:e.root+"/cl/schedule/"+t.tag},(0,l.zw)(t.tag),9,Be)]),(0,l._)("td",null,(0,l.zw)(t.name),1),null!==e.teamings?((0,l.wg)(),(0,l.iD)("td",je,(0,l.zw)(a.teamingName(t.teaming)),1)):(0,l.kq)("v-if",!0)])})),128))])):((0,l.wg)(),(0,l.iD)("div",Fe,Ye))])):(0,l.kq)("v-if",!0)])}]]);var ut=function(){};ut.setup=function(e){e.tables.add({title:"Scheduler",order:100,api:"/api/scheduler/tables"});e.components.addOption({atLeast:Me.N.TA,page:{title:"Main",route:"",order:1},section:{title:"Course",order:5},title:"Schedules",order:11,route:"/schedules",routes:[{route:"/schedules",component:ct}]})},Site.Scheduler||(Site.Scheduler=Ce.create(Site),void 0!==Site.Site.console&&ut.setup(Site.Console))},14121:(e,t,n)=>{n.d(t,{Z:()=>s});var i=n(3041),o=n.n(i),l=n(52281),a=n.n(l)()(o());a.push([e.id,"div.cl-schedule-dialog{width:300px}div.cl-schedule-view div.cl-time{text-align:center;margin:0 0 0 85px;font-size:3em;position:sticky;top:25px;z-index:100;background:#fff}div.cl-schedule-view h2{border:0;text-align:center;padding-left:3.5em}div.cl-schedule-view span.cl-info{font-weight:normal;font-size:.7em}div.cl-schedule-view span.check{position:absolute;left:4px;top:1px;padding:0}div.cl-schedule-view table{border:0;box-shadow:none}div.cl-schedule-view table td:first-child{width:6em;text-align:right;vertical-align:top;border:0;font-size:1em;padding-right:3px}div.cl-schedule-view table td:nth-child(2){position:relative;width:20em;height:4.5em;text-align:center;border-left:1px solid #000;border-right:1px solid #000;border-top:1px solid #000;border-bottom:none}div.cl-schedule-view table td:nth-child(2) span.location{position:absolute;bottom:0;left:0;width:100%;text-align:center;font-style:italic;font-size:.9em}div.cl-schedule-view table td:nth-child(2)>a{text-decoration:none;position:absolute;top:0;left:0;width:100%;padding:.45em 0 0 0;text-align:center;font-style:normal;font-weight:bold;font-size:1.3em;color:#2a2}div.cl-schedule-view table tr:last-child td:nth-child(2){border-bottom:1px solid #000}div.cl-schedule-view table tr.booked td:nth-child(2){background-color:lime;color:#000}div.cl-schedule-view table tr.booked td:nth-child(2) span.booked{position:absolute;top:0;left:0;width:100%;height:2em;padding:.25em 32px 0 0;text-align:center;font-style:normal;font-weight:bold;font-size:1.4em;color:#000;overflow:hidden}div.cl-schedule-view table tr.booked td:nth-child(2) span.booked a,div.cl-schedule-view table tr.booked td:nth-child(2) span.booked a:link,div.cl-schedule-view table tr.booked td:nth-child(2) span.booked a:visited{color:#000;text-decoration:none}div.cl-schedule-view table tr.booked td:nth-child(2) span.booked a:hover{color:red}div.cl-schedule-view table tr.booked td:nth-child(2) span.unbook{position:absolute;right:2px;top:2px;width:32px;height:32px;padding:0}div.cl-schedule-view table tr.booked td:nth-child(2) span.unbook a{padding:0}div.cl-schedule-view table tr.booked td:nth-child(2) span.unbook img{width:32px;height:32px}div.cl-schedule-view table tr.booked span.counter{position:absolute;right:2px;bottom:0}div.cl-schedule-view table tr.owned td:nth-child(2){background-color:#faa}div.cl-schedule-view table tr.gap td{height:10px;padding:0;border:0;line-height:0}div.cl-schedule-view table tr.gap td:nth-child(2){border-top:1px solid #000}",""]);const s=a},77370:(e,t,n)=>{n.d(t,{Z:()=>s});var i=n(3041),o=n.n(i),l=n(52281),a=n.n(l)()(o());a.push([e.id,".flatpickr-input[readonly][data-v-2d7c02fe]{text-align:center}.narrow[data-v-2d7c02fe]{width:3em}",""]);const s=a},24549:(e,t,n)=>{n.d(t,{Z:()=>s});var i=n(3041),o=n.n(i),l=n(52281),a=n.n(l)()(o());a.push([e.id,"div.cl-schedule-team-fetching p{text-align:center;font-size:1.2em;font-style:italic;padding:4em 1em;color:hotpink}p.cl-schedule-team-email{text-align:right;padding:0 2.4em 1em 2em;font-size:.9em}",""]);const s=a}},e=>{e.O(0,[736,77,530,592],(()=>{return t=33547,e(e.s=t);var t}));e.O()}]);